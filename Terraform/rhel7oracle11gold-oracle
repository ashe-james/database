#  Variables

GRID_HOME=/u01/app/grid/11.2.0.4
ORACLE_HOME=/u01/app/oracle/product/11.2.0.4/db
GRID_STAGE=/dbshare/software/11.2.0.4/grid
ORACLE_STAGE=/dbshare/software/11.2.0.4/database


#  grid infrastructure

mkdir -p $GRID_HOME

CHANGEARRAY=(
    INVENTORY_LOCATION=/u01/app/oraInventory
    oracle.install.option=CRS_SWONLY
    ORACLE_BASE=/u01/app/oracle
    ORACLE_HOME=$GRID_HOME
    oracle.install.asm.OSDBA=dba
    oracle.install.asm.OSOPER=dba
    oracle.install.asm.OSASM=dba
)

GRID_RSP=$GRID_STAGE/response/grid_install.rsp
cp $GRID_RSP $GRID_STAGE
GRID_RSP=$GRID_STAGE/grid_install.rsp

for C in "${CHANGEARRAY[@]}"; do 
        O=$( echo $C | cut -d '=' -f1 )=
        U=$( echo $C | sed 's/\//\\\//g' )
	if ( ! grep -q "^$U" $GRID_RSP ); then
        	sed -i "s/$O/$U/g" $GRID_RSP
	fi
done

$GRID_STAGE/runInstaller -silent -responseFile $GRID_RSP

read -p "Press [RETURN] to patch Grid Infrastructure"

$GRID_HOME/OPatch/opatch napply -oh $GRID_HOME -local $GRID_STAGE/../18370031

read -p "Press [RETURN] to install Oracle Database"

#  database

mkdir -p $ORACLE_HOME

CHANGEARRAY=(
    oracle.install.option=INSTALL_DB_SWONLY
    UNIX_GROUP_NAME=oinstall
    INVENTORY_LOCATION=/u01/app/oraInventory
    ORACLE_HOME=$ORACLE_HOME
    ORACLE_BASE=/u01/app/oracle
    oracle.install.db.InstallEdition=EE
    oracle.install.db.DBA_GROUP=dba
    oracle.install.db.OPER_GROUP=dba
    DECLINE_SECURITY_UPDATES=true
)

DB_RSP=$ORACLE_STAGE/response/db_install.rsp
cp $DB_RSP $ORACLE_STAGE
DB_RSP=$ORACLE_STAGE/db_install.rsp

for C in "${CHANGEARRAY[@]}"; do 
        O=$( echo $C | cut -d '=' -f1 )=
        U=$( echo $C | sed 's/\//\\\//g' )
	if ( ! grep -q "^$U" $DB_RSP ); then
        	sed -i "s/$O/$U/g" $DB_RSP
	fi
done

$ORACLE_STAGE/runInstaller -silent -responseFile $DB_RSP